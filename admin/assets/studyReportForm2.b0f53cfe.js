import{_ as S,u as X,b as u,v as K,o,c as l,h as e,t as s,x as L,y as N,r as O,B as M,P,C as B,D as A,j as w,a as C,w as ee,Y as te,Z as ae,F as Y,f as x,d as se,k as oe,T as le,g as q,n as ce,Q as ne}from"./index.b75f8553.js";import{a as re,b as G}from"./datacenter.77b6ffab.js";import{u as F}from"./school.d2c638c4.js";import{_ as de}from"./fire_icon.392f0831.js";import{u as U}from"./teacher.d70bb190.js";import{h as z}from"./handleView.1d4c2813.js";import{s as ue,z as ie}from"./study.86fc9d63.js";import{h as g}from"./moment.9709ab41.js";import{g as _e}from"./ak.cc808f0c.js";import{_ as me}from"./nodata_status.b4bc20a4.js";import"./request.8ef143a7.js";const W=t=>(L("data-v-4ce2ce80"),t=t(),N(),t),ve={class:"all-complete-box flex"},he={class:"left-box"},pe={class:"num"},ye=W(()=>e("span",{class:"per-char"},"%",-1)),fe=W(()=>e("span",{class:"per-char"},"\u5168\u6821\u7D2F\u8BA1\u5B8C\u6210\u6CE8\u518C\u7387",-1)),ge={__name:"PerAllComplete",setup(t){const c=X(),r=()=>{c.push({path:"/CompletionRate"})},n=u(0),I=async()=>{const v={school_id:F().schoolInfo.id},a=await re(v);if(a){const i=a.parent_count||0,p=a.student_should_count||0;p?n.value=Math.ceil(i/p*100):n.value=100}};return K(()=>{I()}),(v,a)=>(o(),l("div",ve,[e("div",he,[e("span",pe,s(n.value),1),ye,fe]),e("div",{class:"look-char",onClick:r},"\u67E5\u770B\u8BE6\u60C5")]))}},Ie=S(ge,[["__scopeId","data-v-4ce2ce80"]]);const b=t=>(L("data-v-8723b320"),t=t(),N(),t),we={class:"grade-class-rank-container"},$e={class:"right-data-wrap"},ke={class:"progress-complete"},Ce={class:"progress-box"},De={class:"flex"},Ye={class:"gc-char"},xe={class:"cp-char"},Me={class:"progress"},Se={class:"fire-icon",src:de,alt:"fire"},be={key:0,class:"per-char gold"},Ee={key:1,class:"per-char silver"},Re={key:2,class:"per-char copper"},Be={class:"data-box flex"},Ae={class:"data-detail-wrap"},Fe=b(()=>e("span",{class:"data-char"},"\u6570\u636E\u6982\u89C8",-1)),Ve={class:"data-item"},Le={class:"num-char"},Ne=b(()=>e("div",{class:"char"},"\u5B66\u4E60\u4EBA\u6B21",-1)),Pe={class:"data-item"},Oe={class:"num-char"},je=b(()=>e("div",{class:"char"},"\u5E74\u7EA7\u4EBA\u6570",-1)),Te={class:"data-item"},qe={class:"num-char"},Ke=b(()=>e("div",{class:"char"},"\u6BCF\u65E5\u4E00\u5B66",-1)),Ge={class:"data-item"},Ue={class:"num-char"},ze=b(()=>e("div",{class:"char"},"\u6BCF\u5468\u4E00\u505A",-1)),We={class:"data-item"},Qe={class:"num-char"},Ze=b(()=>e("div",{class:"char nomar"},"\u6BCF\u6708\u4E00\u8BFE",-1)),He={class:"detail-char"},Je={class:"class-item-wrap"},Xe={class:"flex"},et={class:"class-sec"},tt={class:"class-char"},at={key:0,class:"per-char gold"},st={key:1,class:"per-char silver"},ot={key:2,class:"per-char copper"},lt={class:"teacher-sec flex"},ct={class:"teacher-char"},nt={class:"teacher-char"},rt={class:"progress-wrap"},dt={class:"count-sec flex"},ut={class:"count-tag"},it={class:"count-tag"},_t={__name:"GradeClassRank2",props:{completeItem:{type:Object},completeIndex:{type:Number,default:0},startDate:{type:String,default:""},endDate:{type:String,default:""},filter:{type:String,default:""},rankMode:{type:Number,default:1},currentMonth:{type:Number,default:1}},setup(t,{expose:c}){const r=t,n=u([]),I=async m=>{const y={school_id:F().schoolInfo.id,limit:30,page:1,rank_mode:"class",start_date:r.startDate,end_date:r.endDate,study_type:"all",filter:r.filter,year:m},D=await G(y);n.value=D},v=()=>{a.value=!1},a=u(!1),i=m=>{a.value=!a.value,a.value&&I(m)},p=(m,y)=>{const D=U().teacherList;for(const d of D)if(d.year==m&&d.class_id==y)return d.name},_=m=>Math.ceil(Number(m)*100);return c({doSth:v}),(m,y)=>{const D=O("el-icon");return o(),l("div",we,[e("div",$e,[e("div",ke,[e("div",Ce,[e("div",De,[e("span",Ye,s(M(z)(t.completeItem.year).name),1),e("span",xe,s(t.currentMonth)+"\u6708\u5B66\u4E60\u5B8C\u6210\u7387\u5927\u4E8E"+s(_(t.completeItem.all_percent))+"%",1)]),e("div",Me,[e("div",{class:"progress-active",style:P(`width: ${_(t.completeItem.all_percent)>=100?100:_(t.completeItem.all_percent)}%`)},null,4),B(e("img",Se,null,512),[[A,_(t.completeItem.all_percent)>=100]])])]),t.completeItem.rate=="\u91D1\u699C"?(o(),l("span",be,s(t.completeItem.rate),1)):w("",!0),t.completeItem.rate=="\u94F6\u699C"?(o(),l("span",Ee,s(t.completeItem.rate),1)):w("",!0),t.completeItem.rate=="\u94DC\u699C"?(o(),l("span",Re,s(t.completeItem.rate),1)):w("",!0)]),e("div",Be,[e("div",Ae,[Fe,e("div",Ve,[e("div",Le,s(t.completeItem.all),1),Ne]),e("div",Pe,[e("div",Oe,s(t.completeItem.student_count),1),je]),e("div",Te,[e("div",qe,s(_(t.completeItem.daily_percent))+"% ",1),Ke]),e("div",Ge,[e("div",Ue,s(_(t.completeItem.weekly_percent))+"% ",1),ze]),e("div",We,[e("div",Qe,s(_(t.completeItem.monthy_percent))+"% ",1),Ze])]),e("div",{class:"sw-btn",onClick:y[0]||(y[0]=d=>i(t.completeItem.year))},[e("span",He,s(a.value?"\u6536\u8D77":"\u67E5\u770B")+"\u5E74\u7EA7\u5404\u73ED\u8BE6\u60C5",1),C(D,null,{default:ee(()=>[B(C(M(te),{class:"arr-icon"},null,512),[[A,a.value]]),B(C(M(ae),{class:"arr-icon"},null,512),[[A,!a.value]])]),_:1})])]),B(e("div",Je,[(o(!0),l(Y,null,x(n.value,(d,E)=>(o(),l("div",{class:"class-item",key:E},[e("div",Xe,[e("div",et,[e("span",tt,s(d.class_id)+"\u73ED",1)]),d.rate=="\u91D1\u699C"?(o(),l("span",at,s(d.rate),1)):w("",!0),d.rate=="\u94F6\u699C"?(o(),l("span",st,s(d.rate),1)):w("",!0),d.rate=="\u94DC\u699C"?(o(),l("span",ot,s(d.rate),1)):w("",!0)]),e("div",lt,[e("span",ct,"\u73ED\u4E3B\u4EFB\uFF1A"+s(p(d.year,d.class_id)),1),e("span",nt,"\u5B66\u4E60\u5B8C\u6210\u7387"+s(_(d.all_percent))+"%",1)]),e("div",rt,[e("div",{class:"progress-item",style:P(`width: ${_(d.all_percent)}%`)},null,4)]),e("div",dt,[e("div",ut,"\u5B66\u4E60\u4EBA\u6B21\uFF1A"+s(d.all),1),e("div",it,"\u73ED\u7EA7\u4EBA\u6570\uFF1A"+s(d.student_count),1)])]))),128))],512),[[A,a.value]])])])}}},mt=S(_t,[["__scopeId","data-v-8723b320"]]);function vt(){const t=u({}),c=u({}),r=async()=>{const v={school_id:F().getSchoolInfo.id,type:"term"},a=await ue(v);t.value=a},n=async()=>{const v={school_id:F().getSchoolInfo.id},a=await ie(v);c.value=a};return r(),n(),{studyDashboardCompleteCountRef:t,studyDashboardCompleteDailyRef:c}}const ht=se({name:"CompletedAmountOverview",props:{dataSource:{type:Object,default:()=>({})},dataSourceAvg:{type:Object,default:()=>({})}},setup(t){const c=u({total:{title:"\u603B\u8BBF\u95EE\u91CF",icon:"overview_total_icon_img",num:0,tag:{title:"\u4ECA\u65E5\u65B0\u589E",num:0},averageDaily:{title:"\u65E5\u5747\u8BBF\u95EE\u91CF",num:0}},daily:{title:"\u6BCF\u65E5\u4E00\u5B66\u603B\u5B66\u4E60\u91CF",icon:"overview_daily_icon_img",num:0,tag:{title:"\u4ECA\u65E5\u65B0\u589E",num:0},averageDaily:{title:"\u65E5\u5747\u5B66\u4E60\u91CF",num:0}},weekly:{title:"\u6BCF\u5468\u4E00\u505A\u603B\u5B8C\u6210\u91CF",icon:"overview_weekly_icon_img",num:0,tag:{title:"\u4ECA\u65E5\u65B0\u589E",num:0},averageDaily:{title:"\u65E5\u5747\u5B8C\u6210\u91CF",num:0}},monthy:{title:"\u6BCF\u6708\u4E00\u8BFE\u603B\u5B66\u4E60\u91CF",icon:"overview_monthly_icon_img",num:0,tag:{title:"\u4ECA\u65E5\u65B0\u589E",num:0},averageDaily:{title:"\u65E5\u5747\u5B66\u4E60\u91CF",num:0}}}),r=u(t.dataSource),n=u(t.dataSourceAvg);return oe(()=>{r.value=t.dataSource,n.value=t.dataSourceAvg,Object.keys(r.value).length>0&&(c.value.total.num=r.value.total_all,c.value.total.tag.num=r.value.all_today,c.value.total.averageDaily.num=Math.ceil(n.value.all_num/n.value.day_num),c.value.daily.num=r.value.total_daily,c.value.daily.tag.num=r.value.daily,c.value.daily.averageDaily.num=Math.ceil(n.value.daily/n.value.day_num),c.value.weekly.num=r.value.total_weekly,c.value.weekly.tag.num=r.value.weekly_today,c.value.weekly.averageDaily.num=Math.ceil(n.value.weekly/n.value.day_num),c.value.monthy.num=r.value.total_monthy,c.value.monthy.tag.num=r.value.monthy_today,c.value.monthy.averageDaily.num=Math.ceil(n.value.monthy/n.value.day_num))}),{overviewListRef:c,getImageUrl:_e}}});const pt={class:"completed-amount-overview-container"},yt={class:"completed-amount-overview-ul flex"},ft={class:"el-card-style","body-style":{padding:"0px"}},gt={class:"flex"},It={class:"title-style"},wt={class:"flex-start align-end"},$t={class:"total-num-style"},kt={class:"tag-box flex-center"},Ct={class:"flex-start"},Dt={class:"average-daily-title-style"},Yt={class:"average-daily-num-style"};function xt(t,c,r,n,I,v){const a=O("el-image");return o(),l("div",pt,[e("ul",yt,[(o(!0),l(Y,null,x(t.overviewListRef,(i,p)=>(o(),l("li",{key:p,class:"completed-amount-overview-li"},[e("div",ft,[e("header",gt,[e("p",It,s(i.title),1),C(a,{class:"header-icon-style",src:t.getImageUrl(i.icon+".png")},null,8,["src"])]),e("article",wt,[e("p",$t,s(i.num),1),e("div",kt,[e("p",null,s(i.tag.title),1),e("p",null,s(i.tag.num),1)])]),e("footer",Ct,[e("p",Dt,s(i.averageDaily.title),1),e("p",Yt,s(i.averageDaily.num),1)])])]))),128))])])}const Mt=S(ht,[["render",xt],["__scopeId","data-v-7331e030"]]);const St={class:"class-item"},bt={class:"flex"},Et={class:"class-sec"},Rt={class:"class-char"},Bt={key:0,class:"per-char gold"},At={key:1,class:"per-char silver"},Ft={key:2,class:"per-char copper"},Vt={class:"teacher-sec flex"},Lt={class:"teacher-char"},Nt={class:"teacher-char"},Pt={class:"progress-wrap"},Ot={class:"count-sec flex"},jt={class:"count-tag"},Tt={class:"count-tag"},qt={__name:"ClassRankForComplete2",props:{completeItem:{type:Object,default:()=>{}}},setup(t){const c=(n,I)=>{const v=U().teacherList;for(const a of v)if(a.year==n&&a.class_id==I)return a.name},r=n=>Math.ceil(Number(n)*100);return(n,I)=>(o(),l("div",St,[e("div",bt,[e("div",Et,[e("span",Rt,s(M(z)(t.completeItem.year).name)+" "+s(t.completeItem.class_id)+"\u73ED ",1)]),t.completeItem.rate=="\u91D1\u699C"?(o(),l("span",Bt,s(t.completeItem.rate),1)):w("",!0),t.completeItem.rate=="\u94F6\u699C"?(o(),l("span",At,s(t.completeItem.rate),1)):w("",!0),t.completeItem.rate=="\u94DC\u699C"?(o(),l("span",Ft,s(t.completeItem.rate),1)):w("",!0)]),e("div",Vt,[e("span",Lt,"\u73ED\u4E3B\u4EFB\uFF1A"+s(c(t.completeItem.year,t.completeItem.class_id)),1),e("span",Nt,"\u5B66\u4E60\u5B8C\u6210\u7387"+s(r(t.completeItem.all_percent))+"%",1)]),e("div",Pt,[e("div",{class:"progress-item",style:P(`width: ${r(t.completeItem.all_percent)}%`)},null,4)]),e("div",Ot,[e("div",jt,"\u5B66\u4E60\u4EBA\u6B21\uFF1A"+s(t.completeItem.all),1),e("div",Tt,"\u73ED\u7EA7\u4EBA\u6570\uFF1A"+s(t.completeItem.student_count),1)])]))}},Kt=S(qt,[["__scopeId","data-v-1c369327"]]);const Gt={},Q=t=>(L("data-v-14029ae3"),t=t(),N(),t),Ut={class:"nodata-status-container"},zt=Q(()=>e("img",{class:"nodata-img",src:me,alt:""},null,-1)),Wt=Q(()=>e("span",{class:"nodata-char"},"\u6682\u65E0\u6570\u636E\u5185\u5BB9\uFF0C\u770B\u770B\u5176\u4ED6\u7684\u5427~",-1)),Qt=[zt,Wt];function Zt(t,c){return o(),l("div",Ut,Qt)}const Ht=S(Gt,[["render",Zt],["__scopeId","data-v-14029ae3"]]);const Z=t=>(L("data-v-1f5d6368"),t=t(),N(),t),Jt={class:"study-report-container"},Xt={class:"all-wrap"},ea={class:"sort-wrap"},ta={class:"title-time"},aa=Z(()=>e("span",{class:"study-tit"},"\u5B66\u4E60\u5B8C\u6210\u699C",-1)),sa={class:"time-char"},oa=Z(()=>e("span",{class:"o-char"},"\u5206\u7C7B\uFF1A",-1)),la=["onClick"],ca={key:0,class:"date-picker-wrap"},na={key:1,class:"date-picker-wrap"},ra={key:0,class:"data-wrap"},da={key:0},ua={key:1},ia={class:"class-item-wrap"},_a={__name:"studyReportForm2",setup(t){const{studyDashboardCompleteCountRef:c,studyDashboardCompleteDailyRef:r}=vt(),n=[{sortKey:1,sortItem:[{id:"",name:"\u5168\u90E8"},{id:"\u91D1\u699C",name:"\u91D1\u699C"},{id:"\u94F6\u699C",name:"\u94F6\u699C"},{id:"\u94DC\u699C",name:"\u94DC\u699C"}]},{sortKey:2,sortItem:[{id:1,name:"\u5468\u5B66\u52E4"},{id:2,name:"\u6708\u5B66\u52E4"}]}],{proxy:I}=le(),v=()=>{I.$refs.gradeRef.map(h=>{h.doSth()})},a=u(["",1,"grade"]),i=u(""),p=u(""),_=u(""),m=u(""),y=u("");u("");const D=(h,$)=>{$===""?a.value[2]="grade":["\u91D1\u699C","\u94F6\u699C","\u94DC\u699C"].includes($)&&(a.value[2]="class"),a.value[h-1]=$,V(),ne(()=>{v()})},d=u(""),E=u(""),H=h=>{m.value=g(h).add(1,"day").format("YYYY-MM-DD"),y.value=g(h).add(7,"day").format("YYYY-MM-DD"),V()},J=h=>{i.value=g(h).format("YYYY-MM-01"),h?_.value=g(h).format("M"):_.value="",p.value=g(i.value).add(1,"month").format("YYYY-MM-DD"),V()},R=u([]),V=async()=>{const h={school_id:F().schoolInfo.id,limit:30,page:1,rank_mode:a.value[2],start_date:a.value[1]==2?i.value:m.value,end_date:a.value[1]==2?p.value:y.value,study_type:"all",filter:a.value[0]},$=await G(h);R.value=$},j=u("");return K(()=>{j.value=g().format("YYYY\u5E74MM\u6708DD\u65E5"),_.value=g().month(),p.value=g().format("YYYY-MM-01"),i.value=g(p.value).subtract(1,"month").format("YYYY-MM-DD"),y.value=g().isoWeekday(0).format("YYYY-MM-DD"),m.value=g(y.value).subtract(6,"day").format("YYYY-MM-DD"),d.value=m.value,E.value=g().subtract(1,"month").format("YYYY-MM"),V()}),(h,$)=>{const T=O("el-date-picker");return o(),l("div",Jt,[e("div",null,[C(Mt,{dataSource:M(c),dataSourceAvg:M(r)},null,8,["dataSource","dataSourceAvg"]),e("div",Xt,[C(Ie)]),e("div",ea,[e("div",ta,[aa,e("span",sa,"\u66F4\u65B0\u65F6\u95F4\uFF1A"+s(j.value),1)]),(o(),l(Y,null,x(n,f=>e("div",{class:"sort-sec",key:f.sortKey},[oa,(o(!0),l(Y,null,x(f.sortItem,k=>(o(),l("div",{class:ce(["lab-item",a.value[f.sortKey-1]==k.id?"active":""]),onClick:ma=>D(f.sortKey,k.id),key:k.id},s(k.name),11,la))),128))])),64)),a.value[1]==1?(o(),l("div",ca,[C(T,{modelValue:d.value,"onUpdate:modelValue":$[0]||($[0]=f=>d.value=f),onChange:H,type:"week",format:"YYYY \u7B2C ww \u5468",placeholder:"\u9009\u62E9\u5468"},null,8,["modelValue"])])):w("",!0),a.value[1]==2?(o(),l("div",na,[C(T,{modelValue:E.value,"onUpdate:modelValue":$[1]||($[1]=f=>E.value=f),type:"month",placeholder:"\u9009\u62E9\u6708",onChange:J},null,8,["modelValue"]),B(e("div",{class:"ranking_list_name"},s(_.value)+"\u6708\u6392\u884C\u699C ",513),[[A,_.value]])])):w("",!0)]),R.value&&R.value.length?(o(),l("div",ra,[a.value[0]===""?(o(),l("div",da,[(o(!0),l(Y,null,x(R.value,(f,k)=>(o(),l("div",{class:"mar-wrap",key:k},[C(mt,{ref_for:!0,ref:"gradeRef",completeItem:f,completeIndex:k,startDate:a.value[1]==2?i.value:m.value,endDate:a.value[1]==2?p.value:y.value,filter:a.value[0],rankMode:a.value[2],currentMonth:_.value},null,8,["completeItem","completeIndex","startDate","endDate","filter","rankMode","currentMonth"])]))),128))])):(o(),l("div",ua,[e("div",ia,[(o(!0),l(Y,null,x(R.value,(f,k)=>(o(),q(Kt,{completeItem:f,key:k},null,8,["completeItem"]))),128))])]))])):(o(),q(Ht,{key:1}))])])}}},Da=S(_a,[["__scopeId","data-v-1f5d6368"]]);export{Da as default};
