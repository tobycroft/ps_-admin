import{_ as p,o as d,c as h,h as n,j as r,F as k,f as w,n as m,i as A,t as u,A as T,x as g,y as b,C as _,D as v,E as C,r as y,a as f,w as P}from"./index.333305f4.js";import{d as D,h as x}from"./study.4bfdfa10.js";import{q as N,a as E,b as L}from"./quiz.3fc7c76b.js";const $={props:{width:{type:Number,default:300},height:{type:Number,default:200},chapterId:{type:String,default:""},src:{type:String,defualt:""},initialTime:{type:[Number,String],default:0}},data(){return{videoUrl:"",playTime:0,videoContext:void 0,playStatus:!1}},watch:{chapterId(){this.switchVideoSource()}},mounted(){this.switchVideoSource()},methods:{onPause(){this.pause(),this.playStatus=!1},onPlay(){this.playStatus=!0},onClickNotes(){this.$emit("notes")},videoErrorCallback(t){console.log("\u64AD\u653E\u5F02\u5E38 :>> ",t)},switchVideoSource(){this.videoUrl="#",console.log("this.src :>> ",this.src),setTimeout(()=>{this.videoUrl=this.src},10)},listenPlay(){this.playStatus=!0},timeupdate(t){console.log("event.detail :>> ",t)},pause(){console.log("pause :>> "),this.playStatus&&this.$emit("pause",this.playTime),this.playStatus=!1},ended(){this.playStatus=!1}}},R={class:"video-container"},W=["src","initial-time"];function V(t,e,o,l,i,s){return d(),h("div",R,[n("video",{id:"myVideo",style:{width:"100%",height:"100%"},src:i.videoUrl,"initial-time":o.initialTime,"object-fit":"contain",onPlay:e[0]||(e[0]=(...a)=>s.listenPlay&&s.listenPlay(...a)),onTimeupdate:e[1]||(e[1]=(...a)=>s.timeupdate&&s.timeupdate(...a)),onPause:e[2]||(e[2]=(...a)=>s.pause&&s.pause(...a)),onEnded:e[3]||(e[3]=(...a)=>s.ended&&s.ended(...a)),onError:e[4]||(e[4]=(...a)=>s.videoErrorCallback&&s.videoErrorCallback(...a)),controls:""},null,40,W),r(` <div class="notes-btn-style" @click="onClickNotes">\r
      <IconSvg iconName="video_edit_btn_icon" :width="56" :height="56" />\r
    </div> `)])}const q=p($,[["render",V],["__scopeId","data-v-d30287df"],["__file","E:/work/parents_school_institution_pc/src/components/EveryMonthDetail/components/VideoMod.vue"]]);const z={props:{list:{type:[Array,Object],default:()=>[]},active:{type:[String,Number],default:1}},created(){console.log("this.list :>> ",this.list)},methods:{onTab(t){this.$emit("change",t.value)}}},F=t=>(g("data-v-fab18666"),t=t(),b(),t),U={class:"tabs-container"},G={class:"tabs-header-box"},B={class:"tabs-header-ul-style flex align-start"},j=["onClick"],H=F(()=>n("div",{class:"active-border-style"},null,-1));function Q(t,e,o,l,i,s){return d(),h("div",U,[n("div",G,[n("div",B,[(d(!0),h(k,null,w(o.list,a=>(d(),h("div",{key:a.value,class:m(["tabs-header-li-style",{"tabs-header-li-active-style":o.active===a.value}]),onClick:c=>s.onTab(a)},[A(u(a.name)+" ",1),H],10,j))),128))]),n("div",null,[T(t.$slots,"default",{},void 0,!0)])])])}const O=p(z,[["render",Q],["__scopeId","data-v-fab18666"],["__file","E:/work/parents_school_institution_pc/src/components/EveryMonthDetail/components/Tabs.vue"]]);const J={name:"IntroductionInfo",props:{studentId:{type:String,default:""},taskId:{type:String,default:""},activeMonth:{type:Object,default:()=>{}}},data(){return{taskMonthData:{},rateInfo:{},isCollection:!1,hashFold:!0}},watch:{taskId:{handler(t){this.studyInfoGetAPI(t,"monthy")},immediate:!0}},mounted(){console.log("taskMonthData :>> ",this.taskMonthData),this.studyInfoGetAPI(this.taskId,"monthy")},methods:{onClickCollection(){this.isCollection=!this.isCollection,this.rateInfoAddAPI(this.taskId,this.studentId,this.rateInfo.share,this.isCollection)},onShare(t){console.log("e :>> ",t),this.rateInfoAddAPI(this.taskId,this.studentId,!0,this.rateInfo.like)},onUnfold(){this.hashFold=!this.hashFold},async studyInfoGetAPI(t,e){const l=await D({study_id:t,type:e});console.log("\u6708\u5217\u8868API_res :>> ",l),this.taskMonthData=l}}},K=t=>(g("data-v-663898fc"),t=t(),b(),t),X={class:"introduction-info-container"},Y={class:"introduction-info-header-style flex"},Z={class:"introduction-info-title-style"},tt=K(()=>n("div",{class:"introduction-btn-box-style flex-start"},[r(` <div @click="onClickCollection">\r
            <IconSvg\r
              v-show="rateInfo.like === 0"\r
              iconName="collection_icon"\r
              :width="32"\r
              :height="30"\r
            />\r
            <IconSvg\r
              v-show="rateInfo.like === 1"\r
              iconName="collection_active_icon"\r
              :width="32"\r
              :height="30"\r
            />\r
          </div>\r
          <div class="share-btn-box-style">\r
            <IconSvg iconName="share_two_icon" :width="32" :height="30" />\r
            <button\r
              class="share-btn-style"\r
              open-type="share"\r
              @click="onShare"\r
            />\r
          </div> `)],-1)),et={class:"introduction-info-article-style"},st={class:"lecturer-info-box-style flex-start"},ot={class:"lecturer-name-style"},it={class:"tags-style"},nt={class:"more-wrapper"},at=["innerHTML"];function ct(t,e,o,l,i,s){return d(),h("div",null,[_(n("div",X,[r(" \u7B80\u4ECB\u4FE1\u606F-\u5934\u90E8 "),n("div",Y,[n("div",Z,u(i.taskMonthData.title),1),tt]),r(" \u7B80\u4ECB\u4FE1\u606F-\u5185\u5BB9 "),n("div",et,[n("div",st,[n("div",ot," \u8BB2\u5E08\uFF1A"+u(i.taskMonthData.teacher_info?i.taskMonthData.teacher_info.name:""),1),n("div",it,u(i.taskMonthData.teacher_info?i.taskMonthData.teacher_info.info:""),1)]),n("div",nt,[n("div",{class:m(["task-introduce-style",{"fold-style":i.hashFold}])},[n("div",{class:"detail-btn-style",onClick:e[0]||(e[0]=(...a)=>s.onUnfold&&s.onUnfold(...a))},u(i.hashFold?"\u5C55\u5F00":"\u6298\u53E0"),1),r(` <div v-if="hashFold" class="detail-btn-style" @click="onUnfold">\r
            \u5C55\u5F00\r
          </div> `),r(' <br v-if="taskMonthData.slogan && taskMonthData.content" /> '),n("div",{innerHTML:i.taskMonthData.content},null,8,at)],2)])]),r(` <div class="ios-task-introduce-style" v-if="isIos()">\r
        {{ taskMonthData.slogan }}\r
      </div> `)],512),[[v,i.taskMonthData.title]])])}const lt=p(J,[["render",ct],["__scopeId","data-v-663898fc"],["__file","E:/work/parents_school_institution_pc/src/components/EveryMonthDetail/components/IntroductionInfo.vue"]]),rt="/admin/images/now_play.png";const dt={components:{},props:{active:{type:[String,Number],default:null},taskId:{type:String,default:""}},data(){return{topicList:[]}},watch:{taskId:{handler(t){console.log("month_id directiory",t),this.studyTopicListAPI(t)},immediate:!0}},mounted(){},methods:{onChange(t,e){this.$emit("change",{row:t,index:e})},secondToTime(t,e="true"){const o=parseInt(t);let l=0,i=0,s=0;return e?(l=Math.floor(o/3600)<10?"0"+Math.floor(o/3600):Math.floor(o/3600),i=Math.floor(o/60%60)<10?"0"+Math.floor(o/60%60):Math.floor(o/60%60),s=Math.floor(o%60)<10?"0"+Math.floor(o%60):Math.floor(o%60)):(l=Math.floor(o/3600),i=Math.floor(o/60%60),s=Math.floor(o%60)),{h:l,m:i,s}},handlePlayTime(t){console.log("playTime :>> ",t);const e=this.secondToTime(t,!1);return console.log("time :>> ",e),e.m>0?`${e.m}\u5206\u949F`:`${e.s}\u79D2\u949F`},next(){console.log("\u6267\u884Cnext :>> ");let t=parseInt(this.active);t<this.topicList.length-1&&(t+=1,this.onChange(this.topicList[t],t))},async studyTopicListAPI(t){const o=await x({monthy_id:t,type:"monthy"});this.topicList=o,this.onChange(this.topicList[0],0)}}},ht=t=>(g("data-v-8388d332"),t=t(),b(),t),ut={class:"directory-container"},_t={class:"header-box-style border-bottom-style flex"},vt=ht(()=>n("div",{class:"header-title-style"},"\u76EE\u5F55",-1)),ft={class:"header-total-style"},yt={class:"ul-style"},pt=["onClick"],mt={class:"flex"},It={class:"li-content-length-style"},kt={class:"now-play-image-style",src:rt,mode:""};function wt(t,e,o,l,i,s){return d(),h("div",ut,[n("div",null,[n("div",_t,[vt,n("div",ft,"\u5171"+u(i.topicList.length)+"\u8282",1)]),n("div",yt,[(d(!0),h(k,null,w(i.topicList,(a,c)=>(d(),h("div",{key:c,class:m(["li-style",{"border-bottom-style":c!=5-1}])},[n("div",{class:m(["li-content-style",{"li-content-last-style":c===5-1}]),onClick:I=>s.onChange(a,c)},[n("div",{class:m(["li-content-title-style",{"li-content-title-active-style":o.active===c}])},u(c+1)+". "+u(a.title),3),n("div",mt,[n("div",It,u(s.handlePlayTime(a.attach_duration)),1),_(n("img",kt,null,512),[[v,o.active===c]])])],10,pt)],2))),128))])])])}const gt=p(dt,[["render",wt],["__scopeId","data-v-8388d332"],["__file","E:/work/parents_school_institution_pc/src/components/EveryMonthDetail/components/Directory.vue"]]);const bt={components:{},props:{taskId:{type:Number,default:0}},data(){return{list:[],answerActive:[],result:void 0}},computed:{correctAnswerCmp(){let t="";if(this.result)for(const e of this.result.answerArr)console.log("item :>> ",e),t+=e.title.substring(0,1)+" ";return console.log("str :>> ",t),t},showTipsSuccess(){return this.result?this.result.answerResults==="success":!1},showTipsError(){return this.result?this.result.answerResults==="error":!1},answerState(){return this.result?this.result.answerResults==="error"||this.result.answerResults==="success":!1}},watch:{taskId:{handler(t){this.getListWorkflow()},immediate:!0}},methods:{async getListWorkflow(){this.list=await this.quizQuestionListAPI(this.taskId)},handleAnswerEcho(t){const e=[];t.choices.forEach(o=>{e.push(parseInt(o))}),this.list.selection_info.forEach(o=>{e.forEach(l=>{o.id===l&&(o.checked=!0)})}),this.handleAnswerActive(),this.onSubmit(!1)},changeChecked(t){console.log("\u4FEE\u6539\u9009\u9879 :>> ",t),!this.answerState&&(t.checked=!t.checked,this.handleAnswerActive())},handleAnswerActive(){console.log("this.list :>> ",this.list),this.answerActive=[];for(const t of this.list.selection_info)t.checked&&this.answerActive.push(t.id);console.log("answerActive :>> ",this.answerActive)},handleTips(t){console.log("answer :>> ",t);const e={},o=[],l=[];let i=null;for(const s of this.list.selection_info)s.is_answer===1&&o.push(s);e.answerArr=o;for(const s of o){const a=t.filter(c=>c===s.id);for(const c of a)l.push(c)}return e.activeArr=l,i=o.length===l.length?"success":"error",e.answerResults=i,e},async onSubmit(t=!0){if(t){await this.quizRecordAddAPI(this.list.id,`[${this.answerActive}]`),C({title:"\u7B54\u9898\u6210\u529F",type:"success",success:()=>{this.$emit("submit",this.list),this.result=this.handleTips(this.answerActive),console.log("this.result :>> ",this.result)}});return}this.$emit("submit",this.list),this.result=this.handleTips(this.answerActive),console.log("this.result :>> ",this.result)},onRedo(){this.answerActive=[],this.result=void 0,this.list.selection_info.forEach(t=>{t.checked=!1})},async quizQuestionListAPI(t){const o=await N({study_id:t});console.log("res :>> ",o);for(const l of o[0].selection_info)l.checked=!1;return o[0]},async quizRecordAddAPI(t,e){return await E({question_id:t,type:"monthy",choice:e})},async quizRecordGetAPI(t){return await L({question_id:t,type:"monthy"})}}},Mt={class:"practice-container"},St={class:"practice-box"},At={class:"header-style"},Tt={key:0,class:"ul-style"},Ct=["onClick"],Pt={class:"icon-box"},Dt={class:"answer-options-style"},xt={class:"footer-style"},Nt={class:"tips-box-style"},Et={class:"success-tips-style"};function Lt(t,e,o,l,i,s){const a=y("IconSvg");return d(),h("div",Mt,[n("div",null,[n("div",St,[n("div",At,u(i.list.title),1),i.list.selection_info?(d(),h("div",Tt,[(d(!0),h(k,null,w(i.list.selection_info,(c,I)=>(d(),h("div",{key:I,class:"li-style custom-flex-start",onClick:M=>s.changeChecked(c)},[n("div",Pt,[_(f(a,{iconName:"not_to_choose_icon",width:32,height:32},null,512),[[v,!c.checked]]),_(f(a,{iconName:"regsiter_selected",width:32,height:32},null,512),[[v,c.checked]])]),n("div",Dt,u(c.title),1)],8,Ct))),128))])):r("v-if",!0),n("div",xt,[n("div",Nt,[_(n("div",{class:"error-tips-style"}," \u56DE\u7B54\u9519\u8BEF\uFF0C\u6B63\u786E\u7B54\u6848"+u(s.correctAnswerCmp),513),[[v,s.showTipsError]]),_(n("div",Et," nice~\u56DE\u7B54\u6B63\u786E\uFF01 ",512),[[v,s.showTipsSuccess]])]),s.answerState?r("v-if",!0):(d(),h("div",{key:0,class:"submit-btn-style",onClick:e[0]||(e[0]=(...c)=>s.onSubmit&&s.onSubmit(...c))}," \u63D0\u4EA4 ")),s.answerState?(d(),h("div",{key:1,class:"reset-btn-style",onClick:e[1]||(e[1]=(...c)=>s.onRedo&&s.onRedo(...c))}," \u91CD\u505A ")):r("v-if",!0)])])])])}const $t=p(bt,[["render",Lt],["__scopeId","data-v-1cf697c0"],["__file","E:/work/parents_school_institution_pc/src/components/EveryMonthDetail/components/Practice.vue"]]);const Rt={name:"everyMonthDetail",props:["lookStudyId","lookMonthId"],components:{VideoMod:q,Tabs:O,IntroductionInfo:lt,Directory:gt,Practice:$t},watch:{lookStudyId:{handler(t){console.log("study_id",t),this.taskId=t},immediate:!0},lookMonthId:{handler(t){console.log("month_id",t),this.monthyId=t},immediate:!0}},data(){return{hashHistoryRouter:!1,tabsList:[{name:"\u7B80\u4ECB",value:0},{name:"\u7EC3\u4E60",value:1}],practiceList:{problem:"1.\u5B69\u5B50\u521A\u4E0A\u4E00\u5E74\u7EA7\uFF0C\u5BB6\u957F\u8981\u6709\u56DB\u4E2A\u5FC5\u5907\u7684\u5FC3\u6001\uFF0C\u4EE5\u4E0B\u6B63\u786E\u7684\u662F\uFF08\u591A\u9009\uFF09",options:[{name:"A. \u6559\u80B2\u8D23\u4EFB\u8981\u8BA4\u6E05",value:"A",checked:!1},{name:"B. \u7231\u4E0E\u5173\u6000\u8981\u7ED9\u591F",value:"B",checked:!1},{name:"C. \u7FA4\u4F53\u73AF\u5883\u8981\u9002\u5E94",value:"C",checked:!1},{name:"D. \u5BB6\u6821\u6C9F\u901A\u8981\u7D27\u5BC6",value:"D",checked:!1}]},videoW:null,videoH:null,student_id:"",taskId:"",monthyId:"",activeMonth:{},showWriteNote:!1,activeTab:0,activePlayIndex:0,actrivePlay:{},initialTime:0}},methods:{writeNoteSuccess(){this.$refs.notes.noteInfoListAPI(this.taskId)},changeTab(t){console.log("\u5207\u6362Tabs\u9879_val :>> ",t),this.activeTab=t},async onChangeDirectory(t){console.log("\u5207\u6362\u76EE\u5F55\u9009\u4E2D\u9879_val :>> ",t),this.$refs.video.onPause(),this.activePlayIndex=t.index,this.actrivePlay=t.row,this.$refs.video.onPlay()},handleWriteNote(){this.showWriteNote=!0},closeWriteNote(){this.showWriteNote=!1}}},Wt={class:"every-month-detail-container"},Vt={class:"video-box-style"},qt={class:"operation-box-style"},zt={class:"introduction-box-style"},Ft={class:"directory-style"},Ut={class:"practice-box-style"};function Gt(t,e,o,l,i,s){const a=y("VideoMod"),c=y("IntroductionInfo"),I=y("Directory"),M=y("Practice"),S=y("Tabs");return d(),h("div",Wt,[r(" \u5934\u90E8\u5BFC\u822A "),r(` <uni-nav-bar\r
      dark\r
      :fixed="true"\r
      background-color="#DA4036"\r
      status-bar\r
      :border="false"\r
      left-icon="left"\r
      title="\u6BCF\u6708\u4E00\u8BFE"\r
      @clickLeft="back"\r
    /> `),r(" \u89C6\u9891\u64AD\u653E\u533A\u57DF "),n("div",Vt,[f(a,{class:"video-style",ref:"video",chapterId:i.actrivePlay.id,src:i.actrivePlay.attach_url,initialTime:i.initialTime,onNotes:s.handleWriteNote,onPause:t.onPause,onEnded:t.onEnded},null,8,["chapterId","src","initialTime","onNotes","onPause","onEnded"])]),r(" \u64CD\u4F5C\u533A\u57DF "),n("div",qt,[_(f(S,{list:i.tabsList,active:i.activeTab,onChange:s.changeTab},{default:P(()=>[r(" \u7B80\u4ECB "),_(n("div",zt,[f(c,{studentId:i.student_id,taskId:i.taskId,activeMonth:i.activeMonth},null,8,["studentId","taskId","activeMonth"]),n("div",Ft,[f(I,{ref:"Directory",active:i.activePlayIndex,taskId:i.monthyId,onChange:s.onChangeDirectory},null,8,["active","taskId","onChange"])]),r(` <div class="evaluation-style">\r
            <Evaluation :taskId="taskId" />\r
          </div> `)],512),[[v,i.activeTab===0]]),r(" \u7B14\u8BB0 "),r(` <div v-show="activeTab === 1" class="notes-box-style">\r
          <Notes ref="notes" :taskId="taskId" @write="handleWriteNote"></Notes>\r
        </div> `),r(" \u7EC3\u4E60  "),_(n("div",Ut,[f(M,{taskId:i.taskId},null,8,["taskId"])],512),[[v,i.activeTab===1]])]),_:1},8,["list","active","onChange"]),[[v,!i.showWriteNote]]),r(` <WriteNote\r
        :taskId="taskId"\r
        v-show="showWriteNote"\r
        @close="closeWriteNote"\r
        @success="writeNoteSuccess"\r
      ></WriteNote> `)])])}const Qt=p(Rt,[["render",Gt],["__scopeId","data-v-c59fd7cd"],["__file","E:/work/parents_school_institution_pc/src/components/EveryMonthDetail/EveryMonthDetail.vue"]]);export{Qt as E};
